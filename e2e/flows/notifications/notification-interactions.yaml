appId: com.troodie.troodie.com
---
# Test: Notification interactions and navigation
# Priority: P0 (Critical)
# Tags: notifications, navigation, smoke
# Prerequisites: User logged in, has some notifications

- launchApp

# Ensure logged in
- runFlow: ../helpers/auth.yaml

# Navigate to notifications/activity tab
- tapOn:
    id: "tab-activity"

# Wait for notifications to load
- assertVisible:
    text: "Activity"
    timeout: 10000
    optional: true

- assertVisible:
    text: "Notifications"
    timeout: 10000
    optional: true

# Check if notifications badge exists
- assertVisible:
    id: "notification-badge"
    optional: true

# Verify notification list appears
- assertVisible:
    id: "notification-list"
    optional: true

# Test: Tap on a "like" notification
- scrollUntilVisible:
    element:
      text: "liked your"
    direction: DOWN
    timeout: 5000
    optional: true

- tapOn:
    text: "liked your"
    optional: true

# Should navigate to the liked post
- assertVisible:
    id: "post-detail"
    timeout: 10000
    optional: true

- assertVisible:
    text: "Comments"
    timeout: 5000
    optional: true

# Go back to notifications
- back

# Test: Tap on a "follow" notification
- scrollUntilVisible:
    element:
      text: "started following you"
    direction: DOWN
    timeout: 5000
    optional: true

- tapOn:
    text: "started following you"
    optional: true

# Should navigate to that user's profile
- assertVisible:
    id: "user-profile"
    timeout: 10000
    optional: true

- assertVisible:
    text: "Posts"
    timeout: 5000
    optional: true

# Go back
- back

# Test: Tap on a "comment" notification
- scrollUntilVisible:
    element:
      text: "commented on"
    direction: DOWN
    timeout: 5000
    optional: true

- tapOn:
    text: "commented on"
    optional: true

# Should navigate to post with comments
- assertVisible:
    text: "Comments"
    timeout: 10000
    optional: true

# Go back
- back

# Test: Tap on board invitation
- scrollUntilVisible:
    element:
      text: "invited you to"
    direction: DOWN
    timeout: 5000
    optional: true

- tapOn:
    text: "invited you to"
    optional: true

# Should show invitation modal or board
- assertVisible:
    text: "Invitation"
    timeout: 5000
    optional: true

- tapOn:
    text: "Close"
    optional: true

- back
    optional: true

# Test: Mark notification as read
- longPressOn:
    id: "notification-item-0"
    optional: true

- tapOn:
    text: "Mark as Read"
    optional: true

# Test: Access notification settings
- tapOn:
    id: "notification-settings-button"
    optional: true

- tapOn:
    id: "tab-activity-menu"
    optional: true

- tapOn:
    text: "Settings"
    optional: true

- tapOn:
    text: "Notification Settings"
    optional: true

# Verify notification preferences screen
- assertVisible:
    text: "Notification Preferences"
    timeout: 10000
    optional: true

- assertVisible:
    text: "Push Notifications"
    optional: true

# Toggle a notification preference
- tapOn:
    id: "notification-pref-likes"
    optional: true

- tapOn:
    text: "Likes"
    optional: true

# Save and go back
- tapOn:
    text: "Save"
    optional: true

- back

# Return to notifications
- tapOn:
    id: "tab-activity"
    optional: true

# Take screenshot
- takeScreenshot: "notification-interactions-complete"

# Test: Clear all read notifications (optional)
- tapOn:
    id: "clear-notifications-button"
    optional: true

- tapOn:
    text: "Clear Read"
    optional: true

- tapOn:
    text: "Confirm"
    optional: true
